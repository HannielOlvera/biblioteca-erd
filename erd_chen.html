<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>ERD (Chen) – Biblioteca (estilo examen, sin cruces, más separación)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif;background:#fff;color:#000}
  header{padding:10px 14px;border-bottom:1px solid #ccc;background:#f7f7f7}
  h1{margin:0;font-size:16px;font-weight:600}
  main{overflow:auto}
  .wrap{min-width:2400px;min-height:1400px;display:flex;align-items:flex-start;justify-content:center;padding:10px 0}
  svg{background:#fff}

  /* Estilo monocromo tipo examen */
  .box{fill:#fff;stroke:#000;stroke-width:1}
  .diamond{fill:#fff;stroke:#000;stroke-width:1}
  .oval{fill:#fff;stroke:#000;stroke-width:1}
  .edge{stroke:#000;stroke-width:1;fill:none}

  .label{font:14px Arial, sans-serif; fill:#000}
  .small{font:13px Arial, sans-serif; fill:#000}
  .mini{font:12px Arial, sans-serif; fill:#000}

  /* Botones export opcionales */
  .controls{position:fixed;right:12px;top:10px;display:flex;gap:8px}
  button{appearance:none;border:1px solid #ccc;background:#fff;padding:.35rem .6rem;border-radius:6px;cursor:pointer;font-size:12px}
</style>
</head>
<body>
<header><h1>ERD (Chen) – Biblioteca (sin cruces, mayor separación)</h1></header>

<div class="controls">
  <button id="btnSvg">Exportar SVG</button>
  <button id="btnPng">Exportar PNG</button>
</div>

<main>
  <div class="wrap">
    <!-- Lienzo GRANDE para evitar encimados -->
    <svg id="erd" width="2400" height="1400" viewBox="0 0 2400 1400" xmlns="http://www.w3.org/2000/svg">

      <!-- ========== Fila superior: Geografía -> Usuario -> Préstamo (sin cruces) ========== -->
      <!-- ESTADO -->
      <g id="Estado">
        <rect class="box" x="60" y="220" width="160" height="48" rx="4"/>
        <text class="label" x="140" y="250" text-anchor="middle">Estado</text>
        <!-- Atributos -->
        <ellipse class="oval" cx="90"  cy="160" rx="65" ry="22"/><text class="mini" x="90"  y="164" text-anchor="middle">ID_estado</text>
        <path class="edge" d="M100 220 L98 182" />
        <ellipse class="oval" cx="210" cy="160" rx="60" ry="22"/><text class="mini" x="210" y="164" text-anchor="middle">Nombre</text>
        <path class="edge" d="M180 220 L195 182" />
      </g>

      <!-- PERTENECE (Ciudad-Estado) -->
      <g id="R_Ciu_Est">
        <polygon class="diamond" points="265,244 290,224 315,244 290,264"/>
        <text class="small" x="290" y="248" text-anchor="middle">Pertenece</text>
      </g>

      <!-- CIUDAD -->
      <g id="Ciudad">
        <rect class="box" x="360" y="220" width="160" height="48" rx="4"/>
        <text class="label" x="440" y="250" text-anchor="middle">Ciudad</text>
        <ellipse class="oval" cx="390" cy="160" rx="62" ry="22"/><text class="mini" x="390" y="164" text-anchor="middle">ID_ciudad</text>
        <path class="edge" d="M400 220 L398 182" />
        <ellipse class="oval" cx="520" cy="160" rx="60" ry="22"/><text class="mini" x="520" y="164" text-anchor="middle">Nombre</text>
        <path class="edge" d="M500 220 L510 182" />
      </g>

      <!-- Cardinalidades Ciudad-Estado -->
      <path class="edge" d="M220 244 L265 244" />
      <text class="small" x="235" y="234">1</text>
      <path class="edge" d="M315 244 L360 244" />
      <text class="small" x="338" y="234">N</text>

      <!-- PERTENECE (Colonia-Ciudad) -->
      <g id="R_Col_Ciu">
        <polygon class="diamond" points="565,244 590,224 615,244 590,264"/>
        <text class="small" x="590" y="248" text-anchor="middle">Pertenece</text>
      </g>

      <!-- COLONIA -->
      <g id="Colonia">
        <rect class="box" x="660" y="220" width="160" height="48" rx="4"/>
        <text class="label" x="740" y="250" text-anchor="middle">Colonia</text>
        <ellipse class="oval" cx="690" cy="160" rx="62" ry="22"/><text class="mini" x="690" y="164" text-anchor="middle">ID_colonia</text>
        <path class="edge" d="M705 220 L700 182" />
        <ellipse class="oval" cx="820" cy="160" rx="60" ry="22"/><text class="mini" x="820" y="164" text-anchor="middle">Nombre</text>
        <path class="edge" d="M800 220 L810 182" />
        <ellipse class="oval" cx="820" cy="300" rx="40" ry="20"/><text class="mini" x="820" y="304" text-anchor="middle">CP</text>
        <path class="edge" d="M800 268 L810 284" />
      </g>

      <!-- Cardinalidades Colonia-Ciudad -->
      <path class="edge" d="M520 244 L565 244" />
      <text class="small" x="535" y="234">1</text>
      <path class="edge" d="M615 244 L660 244" />
      <text class="small" x="638" y="234">N</text>

      <!-- PERTENECE (Dirección-Colonia) -->
      <g id="R_Dir_Col">
        <polygon class="diamond" points="865,244 890,224 915,244 890,264"/>
        <text class="small" x="890" y="248" text-anchor="middle">Pertenece</text>
      </g>

      <!-- DIRECCIÓN -->
      <g id="Direccion">
        <rect class="box" x="960" y="220" width="190" height="48" rx="4"/>
        <text class="label" x="1055" y="250" text-anchor="middle">Dirección</text>
        <ellipse class="oval" cx="980" cy="160" rx="72" ry="22"/><text class="mini" x="980" y="164" text-anchor="middle">ID_direccion</text>
        <path class="edge" d="M1000 220 L995 182" />
        <ellipse class="oval" cx="1140" cy="160" rx="54" ry="22"/><text class="mini" x="1140" y="164" text-anchor="middle">Calle</text>
        <path class="edge" d="M1120 220 L1130 182" />
        <ellipse class="oval" cx="980" cy="310" rx="90" ry="22"/><text class="mini" x="980" y="314" text-anchor="middle">NumeroExterior</text>
        <path class="edge" d="M1000 268 L995 288" />
        <ellipse class="oval" cx="1130" cy="310" rx="90" ry="22"/><text class="mini" x="1130" y="314" text-anchor="middle">NumeroInterior</text>
        <path class="edge" d="M1110 268 L1120 288" />
        <ellipse class="oval" cx="1055" cy="360" rx="72" ry="22"/><text class="mini" x="1055" y="364" text-anchor="middle">Referencia</text>
        <path class="edge" d="M1055 268 L1055 338" />
      </g>

      <!-- Cardinalidades Dirección-Colonia -->
      <path class="edge" d="M820 244 L865 244" />
      <text class="small" x="835" y="234">1</text>
      <path class="edge" d="M915 244 L960 244" />
      <text class="small" x="938" y="234">N</text>

      <!-- VIVE_EN (Usuario-Dirección) -->
      <g id="R_Usr_Dir">
        <polygon class="diamond" points="1190,244 1215,224 1240,244 1215,264"/>
        <text class="small" x="1215" y="248" text-anchor="middle">Vive en</text>
      </g>

      <!-- USUARIO -->
      <g id="Usuario">
        <rect class="box" x="1280" y="220" width="170" height="48" rx="4"/>
        <text class="label" x="1365" y="250" text-anchor="middle">Usuario</text>
        <!-- Arriba -->
        <ellipse class="oval" cx="1305" cy="160" rx="55" ry="22"/><text class="mini" x="1305" y="164" text-anchor="middle">ID_usu</text>
        <path class="edge" d="M1320 220 L1315 182" />
        <ellipse class="oval" cx="1435" cy="160" rx="55" ry="22"/><text class="mini" x="1435" y="164" text-anchor="middle">Nombre</text>
        <path class="edge" d="M1410 220 L1420 182" />
        <!-- Abajo, bien separados -->
        <ellipse class="oval" cx="1290" cy="310" rx="58" ry="22"/><text class="mini" x="1290" y="314" text-anchor="middle">Apellido</text>
        <path class="edge" d="M1310 268 L1305 290" />
        <ellipse class="oval" cx="1365" cy="360" rx="62" ry="22"/><text class="mini" x="1365" y="364" text-anchor="middle">Email</text>
        <path class="edge" d="M1365 268 L1365 338" />
        <ellipse class="oval" cx="1440" cy="310" rx="64" ry="22"/><text class="mini" x="1440" y="314" text-anchor="middle">FechaNac</text>
        <path class="edge" d="M1420 268 L1430 290" />
        <ellipse class="oval" cx="1490" cy="360" rx="62" ry="22"/><text class="mini" x="1490" y="364" text-anchor="middle">Género</text>
        <path class="edge" d="M1450 268 L1472 338" />
        <ellipse class="oval" cx="1525" cy="260" rx="68" ry="22"/><text class="mini" x="1525" y="264" text-anchor="middle">Teléfono</text>
        <path class="edge" d="M1450 244 L1495 252" />
      </g>

      <!-- Cardinalidades Usuario-Dirección (N:1) -->
      <path class="edge" d="M1150 244 L1190 244" />
      <text class="small" x="1165" y="234">1</text>
      <path class="edge" d="M1240 244 L1280 244" />
      <text class="small" x="1260" y="234">N</text>

      <!-- ES_DE (Usuario-Tipo_Usuario) arriba amplio -->
      <g id="R_Usr_Tipo">
        <polygon class="diamond" points="1370,120 1395,100 1420,120 1395,140"/>
        <text class="small" x="1395" y="124" text-anchor="middle">Es de</text>
      </g>
      <g id="Tipo_Usuario">
        <rect class="box" x="1340" y="40" width="220" height="40" rx="4"/>
        <text class="small" x="1450" y="65" text-anchor="middle">Tipo_Usuario</text>
        <ellipse class="oval" cx="1450" cy="10" rx="80" ry="20"/><text class="mini" x="1450" y="14" text-anchor="middle">Descripcion</text>
        <path class="edge" d="M1450 40 L1450 30" />
        <ellipse class="oval" cx="1580" cy="60" rx="72" ry="20"/><text class="mini" x="1580" y="64" text-anchor="middle">ID_tipousu</text>
        <path class="edge" d="M1560 60 L1558 60" />
      </g>
      <path class="edge" d="M1370 220 L1370 140" /><text class="small" x="1376" y="180">N</text>
      <path class="edge" d="M1420 120 L1450 120 L1450 80" /><text class="small" x="1456" y="100">1</text>

      <!-- REALIZA (Usuario-Préstamo) -->
      <g id="R_Realiza">
        <polygon class="diamond" points="1660,244 1685,224 1710,244 1685,264"/>
        <text class="small" x="1685" y="248" text-anchor="middle">Realiza</text>
        <text class="small" x="1685" y="212" text-anchor="middle">1:N</text>
      </g>

      <!-- PRÉSTAMO -->
      <g id="Prestamo">
        <rect class="box" x="1750" y="220" width="190" height="48" rx="4"/>
        <text class="label" x="1845" y="250" text-anchor="middle">Préstamo</text>
        <!-- Atributos muy separados (arriba/abajo) -->
        <ellipse class="oval" cx="1765" cy="160" rx="78" ry="22"/><text class="mini" x="1765" y="164" text-anchor="middle">ID_prestamo</text>
        <path class="edge" d="M1785 220 L1780 182" />
        <ellipse class="oval" cx="1925" cy="160" rx="88" ry="22"/><text class="mini" x="1925" y="164" text-anchor="middle">FechaPrestamo</text>
        <path class="edge" d="M1905 220 L1915 182" />
        <ellipse class="oval" cx="1765" cy="310" rx="140" ry="24"/><text class="mini" x="1765" y="314" text-anchor="middle">FechaDevolucionEsperada</text>
        <path class="edge" d="M1785 268 L1778 288" />
        <ellipse class="oval" cx="1925" cy="310" rx="120" ry="24"/><text class="mini" x="1925" y="314" text-anchor="middle">FechaDevolucionReal</text>
        <path class="edge" d="M1905 268 L1915 288" />
        <ellipse class="oval" cx="1995" cy="260" rx="55" ry="22"/><text class="mini" x="1995" y="264" text-anchor="middle">Status</text>
        <path class="edge" d="M1940 244 L1970 252" />
      </g>

      <!-- Conexiones Usuario—Realiza—Préstamo -->
      <path class="edge" d="M1450 244 L1660 244" />
      <text class="small" x="1475" y="234">1</text>
      <path class="edge" d="M1710 244 L1750 244" />
      <text class="small" x="1730" y="234">*</text>

      <!-- ========== Fila media: Contiene — Libro y “estrella” del libro (sin cruces) ========== -->

      <!-- CONTIENE (N:M) debajo de Préstamo -->
      <g id="R_Contiene">
        <polygon class="diamond" points="1845,470 1870,450 1895,470 1870,490"/>
        <text class="small" x="1870" y="474" text-anchor="middle">Contiene</text>
        <text class="small" x="1900" y="444">N:M</text>
      </g>
      <!-- Codo desde Prestamo hacia abajo (espaciado) -->
      <path class="edge" d="M1845 268 L1845 420 L1845 450" />
      <text class="small" x="1852" y="402">*</text>

      <!-- LIBRO a la derecha -->
      <g id="Libro">
        <rect class="box" x="1980" y="450" width="170" height="48" rx="4"/>
        <text class="label" x="2065" y="480" text-anchor="middle">Libro</text>
        <!-- Atributos: todos, muy espaciados -->
        <ellipse class="oval" cx="1980" cy="395" rx="65" ry="22"/><text class="mini" x="1980" y="399" text-anchor="middle">ID_libro</text>
        <path class="edge" d="M2000 450 L1994 417" />
        <ellipse class="oval" cx="2140" cy="395" rx="55" ry="22"/><text class="mini" x="2140" y="399" text-anchor="middle">Titulo</text>
        <path class="edge" d="M2120 450 L2130 417" />
        <ellipse class="oval" cx="1970" cy="540" rx="70" ry="22"/><text class="mini" x="1970" y="544" text-anchor="middle">Subtitulo</text>
        <path class="edge" d="M1990 498 L1982 520" />
        <ellipse class="oval" cx="2145" cy="540" rx="60" ry="22"/><text class="mini" x="2145" y="544" text-anchor="middle">ISBN13</text>
        <path class="edge" d="M2120 498 L2132 520" />
        <ellipse class="oval" cx="2065" cy="585" rx="60" ry="22"/><text class="mini" x="2065" y="589" text-anchor="middle">ISBN10</text>
        <path class="edge" d="M2065 498 L2065 565" />
        <ellipse class="oval" cx="2215" cy="490" rx="50" ry="20"/><text class="mini" x="2215" y="494" text-anchor="middle">Edicion</text>
        <path class="edge" d="M2150 474 L2193 484" />
        <ellipse class="oval" cx="2215" cy="445" rx="90" ry="22"/><text class="mini" x="2215" y="449" text-anchor="middle">AnioPublicacion</text>
        <path class="edge" d="M2150 466 L2193 456" />
      </g>

      <!-- Conexión CONTIENE—LIBRO -->
      <path class="edge" d="M1895 470 L1980 470" />
      <text class="small" x="1938" y="460">*</text>

      <!-- PUBLICADO_POR (N:1) hacia EDITORIAL (arriba de LIBRO, bien separado) -->
      <g id="R_Publicado">
        <polygon class="diamond" points="2050,380 2075,360 2100,380 2075,400"/>
        <text class="small" x="2075" y="384" text-anchor="middle">Publicado por</text>
      </g>
      <g id="Editorial">
        <rect class="box" x="2020" y="300" width="160" height="42" rx="4"/>
        <text class="small" x="2100" y="326" text-anchor="middle">Editorial</text>
        <ellipse class="oval" cx="2200" cy="318" rx="80" ry="20"/><text class="mini" x="2200" y="322" text-anchor="middle">ID_editorial</text>
        <path class="edge" d="M2180 318 L2178 318" />
        <ellipse class="oval" cx="1960" cy="318" rx="62" ry="20"/><text class="mini" x="1960" y="322" text-anchor="middle">Nombre</text>
        <path class="edge" d="M2020 318 L2015 318" />
      </g>
      <path class="edge" d="M2065 450 L2065 400" /><text class="small" x="2072" y="420">N</text>
      <path class="edge" d="M2075 360 L2075 342" /><text class="small" x="2082" y="346">1</text>

      <!-- ES_TIPO (N:1) a TIPO_LIBRO (a la derecha lejos) -->
      <g id="R_Tipo">
        <polygon class="diamond" points="2170,470 2195,450 2220,470 2195,490"/>
        <text class="small" x="2195" y="474" text-anchor="middle">Es tipo</text>
      </g>
      <g id="Tipo_Libro">
        <rect class="box" x="2250" y="450" width="170" height="48" rx="4"/>
        <text class="small" x="2335" y="480" text-anchor="middle">Tipo_Libro</text>
        <ellipse class="oval" cx="2335" cy="395" rx="90" ry="22"/><text class="mini" x="2335" y="399" text-anchor="middle">ID_tipolibro</text>
        <path class="edge" d="M2335 450 L2335 418" />
        <ellipse class="oval" cx="2335" cy="540" rx="98" ry="22"/><text class="mini" x="2335" y="544" text-anchor="middle">Descripcion</text>
        <path class="edge" d="M2335 498 L2335 520" />
      </g>
      <path class="edge" d="M2150 470 L2170 470" /><text class="small" x="2160" y="460">N</text>
      <path class="edge" d="M2220 470 L2250 470" /><text class="small" x="2235" y="460">1</text>

      <!-- EN_IDIOMA (N:1) a IDIOMA (aún más a la derecha) -->
      <g id="R_Idioma">
        <polygon class="diamond" points="2420,470 2445,450 2470,470 2445,490"/>
        <text class="small" x="2445" y="474" text-anchor="middle">En idioma</text>
      </g>
      <g id="Idioma">
        <rect class="box" x="2500" y="450" width="160" height="48" rx="4"/>
        <text class="small" x="2580" y="480" text-anchor="middle">Idioma</text>
        <ellipse class="oval" cx="2580" cy="395" rx="88" ry="22"/><text class="mini" x="2580" y="399" text-anchor="middle">ID_idioma</text>
        <path class="edge" d="M2580 450 L2580 418" />
        <ellipse class="oval" cx="2580" cy="540" rx="98" ry="22"/><text class="mini" x="2580" y="544" text-anchor="middle">Descripcion</text>
        <path class="edge" d="M2580 498 L2580 520" />
      </g>
      <!-- Nota: el lienzo es amplio; estas x>2400 siguen visibles por min-width. -->

      <!-- SE CLASIFICA (N:M) con GÉNERO (debajo derecha, sin cruzar) -->
      <g id="R_Clasifica">
        <polygon class="diamond" points="2140,680 2165,660 2190,680 2165,700"/>
        <text class="small" x="2165" y="684" text-anchor="middle">Se clasifica</text>
        <text class="small" x="2198" y="674">N:M</text>
      </g>
      <g id="Genero">
        <rect class="box" x="2240" y="740" width="150" height="42" rx="4"/>
        <text class="small" x="2315" y="765" text-anchor="middle">Género</text>
        <ellipse class="oval" cx="2315" cy="700" rx="86" ry="22"/><text class="mini" x="2315" y="704" text-anchor="middle">ID_genero</text>
        <path class="edge" d="M2315 740 L2315 722" />
        <ellipse class="oval" cx="2315" cy="820" rx="98" ry="22"/><text class="mini" x="2315" y="824" text-anchor="middle">Descripcion</text>
        <path class="edge" d="M2315 782 L2315 798" />
      </g>
      <path class="edge" d="M2065 498 L2065 640 L2140 640 L2140 680" /><text class="small" x="2072" y="616">*</text>
      <path class="edge" d="M2190 680 L2240 680 L2240 740" /><text class="small" x="2210" y="670">*</text>

      <!-- ESCRIBE (N:M) con AUTOR (debajo de LIBRO) -->
      <g id="R_Escribe">
        <polygon class="diamond" points="1980,640 2005,620 2030,640 2005,660"/>
        <text class="small" x="2005" y="644" text-anchor="middle">Escribe</text>
        <text class="small" x="2036" y="634">N:M</text>
      </g>
      <g id="Autor">
        <rect class="box" x="1960" y="720" width="180" height="48" rx="4"/>
        <text class="small" x="2050" y="750" text-anchor="middle">Autor</text>
        <ellipse class="oval" cx="1930" cy="780" rx="82" ry="22"/><text class="mini" x="1930" y="784" text-anchor="middle">ID_autor</text>
        <path class="edge" d="M1960 744 L1945 762" />
        <ellipse class="oval" cx="2150" cy="780" rx="74" ry="22"/><text class="mini" x="2150" y="784" text-anchor="middle">Nombre</text>
        <path class="edge" d="M2140 744 L2146 762" />
        <ellipse class="oval" cx="2050" cy="840" rx="76" ry="22"/><text class="mini" x="2050" y="844" text-anchor="middle">Apellido</text>
        <path class="edge" d="M2050 768 L2050 818" />
      </g>
      <path class="edge" d="M2065 498 L2065 600 L2030 600 L2030 620" /><text class="small" x="2058" y="576">*</text>
      <path class="edge" d="M2005 660 L2005 720" /><text class="small" x="2012" y="700">*</text>

      <!-- ========== Fin del diagrama ========== -->

    </svg>
  </div>
</main>

<script>
  // Export helpers
  function exportSVG(){
    const svg = document.getElementById('erd');
    const xml = new XMLSerializer().serializeToString(svg);
    const blob = new Blob(['<?xml version="1.0" encoding="UTF-8"?>\\n' + xml], {type:'image/svg+xml'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = 'ERD_Biblioteca_sin_cruces_espaciado.svg';
    document.body.appendChild(a); a.click(); setTimeout(()=>{URL.revokeObjectURL(url); a.remove();},0);
  }
  function exportPNG(){
    const svg = document.getElementById('erd');
    const xml = new XMLSerializer().serializeToString(svg);
    const img = new Image();
    img.onload = function(){
      const scale = 2;
      const canvas = document.createElement('canvas');
      canvas.width = img.width * scale;
      canvas.height = img.height * scale;
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = '#fff'; ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      canvas.toBlob(b => {
        const url = URL.createObjectURL(b);
        const a = document.createElement('a'); a.href = url; a.download = 'ERD_Biblioteca_sin_cruces_espaciado.png';
        document.body.appendChild(a); a.click(); setTimeout(()=>{URL.revokeObjectURL(url); a.remove();},0);
      }, 'image/png', 1.0);
    };
    img.src = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<?xml version="1.0"?>\\n' + xml);
  }
  document.getElementById('btnSvg').onclick = exportSVG;
  document.getElementById('btnPng').onclick = exportPNG;
</script>
</body>
</html>