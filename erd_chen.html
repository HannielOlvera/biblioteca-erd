<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>ERD (Chen) – Biblioteca (espaciado extremo, sin cruces, V13)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif;background:#fff;color:#000}
  header{padding:10px 14px;border-bottom:1px solid #ccc;background:#f7f7f7}
  h1{margin:0;font-size:16px;font-weight:600}
  main{overflow:auto}
  .wrap{min-width:6000px;min-height:4000px;display:flex;align-items:flex-start;justify-content:center;padding:12px}
  svg{background:#fff}
  /* Estilo examen monocromo */
  .box{fill:#fff;stroke:#000;stroke-width:1}
  .diamond{fill:#fff;stroke:#000;stroke-width:1}
  .oval{fill:#fff;stroke:#000;stroke-width:1}
  .edge{stroke:#000;stroke-width:1;fill:none}
  .label{font:15px Arial, sans-serif; fill:#000}
  .small{font:14px Arial, sans-serif; fill:#000}
  .mini{font:13px Arial, sans-serif; fill:#000}
  .controls{position:fixed;right:12px;top:10px;display:flex;gap:8px}
  button{appearance:none;border:1px solid #ccc;background:#fff;padding:.35rem .6rem;border-radius:6px;cursor:pointer;font-size:12px}
</style>
</head>
<body>
<header><h1>ERD – Biblioteca (espaciado extremo, sin cruces, V13)</h1></header>

<div class="controls">
  <button id="btnSvg">Exportar SVG</button>
  <button id="btnPng">Exportar PNG</button>
</div>

<main>
  <div class="wrap">
    <svg id="erd" width="6000" height="4000" viewBox="0 0 6000 4000" xmlns="http://www.w3.org/2000/svg">
      
      <!-- ===================== BANDA SUPERIOR: GEO / USUARIO / PRÉSTAMO ===================== -->
      
      <!-- ESTADO -->
      <g id="Estado">
        <rect class="box" x="200" y="500" width="280" height="60" rx="4"/>
        <text class="label" x="340" y="536" text-anchor="middle">Estado</text>
        
        <ellipse class="oval" cx="250" cy="350" rx="100" ry="26"/><text class="mini" x="250" y="354" text-anchor="middle">ID_estado</text>
        <path class="edge" d="M250 350 L250 500" />
        
        <ellipse class="oval" cx="420" cy="350" rx="96" ry="26"/><text class="mini" x="420" y="354" text-anchor="middle">Nombre</text>
        <path class="edge" d="M420 350 L420 500" />
      </g>

      <!-- ESTADO -> CIUDAD -->
      <g id="R_Ciu_Est">
        <polygon class="diamond" points="640,530 680,500 720,530 680,560"/>
        <text class="small" x="680" y="536" text-anchor="middle">Pertenece</text>
      </g>
      <path class="edge" d="M480 530 L640 530" /><text class="small" x="540" y="518">1</text>

      <!-- CIUDAD -->
      <g id="Ciudad">
        <rect class="box" x="800" y="500" width="280" height="60" rx="4"/>
        <text class="label" x="940" y="536" text-anchor="middle">Ciudad</text>
        
        <ellipse class="oval" cx="850" cy="350" rx="102" ry="26"/><text class="mini" x="850" y="354" text-anchor="middle">ID_ciudad</text>
        <path class="edge" d="M850 350 L850 500" />
        
        <ellipse class="oval" cx="1030" cy="350" rx="96" ry="26"/><text class="mini" x="1030" y="354" text-anchor="middle">Nombre</text>
        <path class="edge" d="M1030 350 L1030 500" />
      </g>
      <path class="edge" d="M720 530 L800 530" /><text class="small" x="760" y="518">N</text>

      <!-- CIUDAD -> COLONIA -->
      <g id="R_Col_Ciu">
        <polygon class="diamond" points="1240,530 1280,500 1320,530 1280,560"/>
        <text class="small" x="1280" y="536" text-anchor="middle">Pertenece</text>
      </g>
      <path class="edge" d="M1080 530 L1240 530" /><text class="small" x="1150" y="518">1</text>

      <!-- COLONIA -->
      <g id="Colonia">
        <rect class="box" x="1400" y="500" width="300" height="60" rx="4"/>
        <text class="label" x="1550" y="536" text-anchor="middle">Colonia</text>
        
        <ellipse class="oval" cx="1450" cy="350" rx="110" ry="26"/><text class="mini" x="1450" y="354" text-anchor="middle">ID_colonia</text>
        <path class="edge" d="M1450 350 L1450 500" />
        
        <ellipse class="oval" cx="1650" cy="350" rx="100" ry="26"/><text class="mini" x="1650" y="354" text-anchor="middle">Nombre</text>
        <path class="edge" d="M1650 350 L1650 500" />
        
        <ellipse class="oval" cx="1650" cy="650" rx="70" ry="24"/><text class="mini" x="1650" y="654" text-anchor="middle">CP</text>
        <path class="edge" d="M1650 560 L1650 626" />
      </g>
      <path class="edge" d="M1320 530 L1400 530" /><text class="small" x="1360" y="518">N</text>

      <!-- COLONIA -> DIRECCIÓN -->
      <g id="R_Dir_Col">
        <polygon class="diamond" points="1840,530 1880,500 1920,530 1880,560"/>
        <text class="small" x="1880" y="536" text-anchor="middle">Pertenece</text>
      </g>
      <path class="edge" d="M1700 530 L1840 530" /><text class="small" x="1760" y="518">1</text>

      <!-- DIRECCIÓN -->
      <g id="Direccion">
        <rect class="box" x="2000" y="500" width="340" height="60" rx="4"/>
        <text class="label" x="2170" y="536" text-anchor="middle">Dirección</text>
        
        <ellipse class="oval" cx="2050" cy="350" rx="120" ry="26"/><text class="mini" x="2050" y="354" text-anchor="middle">ID_direccion</text>
        <path class="edge" d="M2050 350 L2050 500" />
        
        <ellipse class="oval" cx="2290" cy="350" rx="100" ry="26"/><text class="mini" x="2290" y="354" text-anchor="middle">Calle</text>
        <path class="edge" d="M2290 350 L2290 500" />
        
        <ellipse class="oval" cx="2050" cy="700" rx="150" ry="26"/><text class="mini" x="2050" y="704" text-anchor="middle">NumeroExterior</text>
        <path class="edge" d="M2050 560 L2050 674" />
        
        <ellipse class="oval" cx="2290" cy="700" rx="150" ry="26"/><text class="mini" x="2290" y="704" text-anchor="middle">NumeroInterior</text>
        <path class="edge" d="M2290 560 L2290 674" />
        
        <ellipse class="oval" cx="2170" cy="800" rx="120" ry="26"/><text class="mini" x="2170" y="804" text-anchor="middle">Referencia</text>
        <path class="edge" d="M2170 560 L2170 774" />
      </g>
      <path class="edge" d="M1920 530 L2000 530" /><text class="small" x="1960" y="518">N</text>

      <!-- DIRECCIÓN -> USUARIO -->
      <g id="R_Usr_Dir">
        <polygon class="diamond" points="2500,530 2540,500 2580,530 2540,560"/>
        <text class="small" x="2540" y="536" text-anchor="middle">Vive en</text>
      </g>
      <path class="edge" d="M2340 530 L2500 530" /><text class="small" x="2400" y="518">1</text>

      <!-- USUARIO -->
      <g id="Usuario">
        <rect class="box" x="2700" y="500" width="340" height="60" rx="4"/>
        <text class="label" x="2870" y="536" text-anchor="middle">Usuario</text>
        
        <!-- Atributos superiores muy espaciados -->
        <ellipse class="oval" cx="2700" cy="350" rx="112" ry="26"/><text class="mini" x="2700" y="354" text-anchor="middle">ID_usu</text>
        <path class="edge" d="M2700 350 L2700 500" />
        
        <ellipse class="oval" cx="2870" cy="350" rx="108" ry="26"/><text class="mini" x="2870" y="354" text-anchor="middle">Nombre</text>
        <path class="edge" d="M2870 350 L2870 500" />
        
        <ellipse class="oval" cx="3040" cy="350" rx="108" ry="26"/><text class="mini" x="3040" y="354" text-anchor="middle">Teléfono</text>
        <path class="edge" d="M3040 350 L3040 500" />
        
        <!-- Atributos inferiores -->
        <ellipse class="oval" cx="2700" cy="700" rx="116" ry="26"/><text class="mini" x="2700" y="704" text-anchor="middle">Apellido</text>
        <path class="edge" d="M2700 560 L2700 674" />
        
        <ellipse class="oval" cx="2870" cy="800" rx="124" ry="26"/><text class="mini" x="2870" y="804" text-anchor="middle">Email</text>
        <path class="edge" d="M2870 560 L2870 774" />
        
        <ellipse class="oval" cx="3040" cy="700" rx="124" ry="26"/><text class="mini" x="3040" y="704" text-anchor="middle">FechaNac</text>
        <path class="edge" d="M3040 560 L3040 674" />
        
        <ellipse class="oval" cx="3180" cy="800" rx="96" ry="26"/><text class="mini" x="3180" y="804" text-anchor="middle">Género</text>
        <path class="edge" d="M3040 530 L3180 530 L3180 774" />
      </g>
      <path class="edge" d="M2580 530 L2700 530" /><text class="small" x="2640" y="518">N</text>

      <!-- ES DE -> TIPO_USUARIO (con desvío para evitar "Nombre") -->
      <g id="R_Usr_Tipo">
        <polygon class="diamond" points="2870,250 2910,220 2950,250 2910,280"/>
        <text class="small" x="2910" y="256" text-anchor="middle">Es de</text>
      </g>
      <!-- Ruta que evita completamente "Nombre" -->
      <path class="edge" d="M2870 350 L2870 280" /><text class="small" x="2855" y="310">N</text>

      <!-- TIPO_USUARIO -->
      <g id="Tipo_Usuario">
        <rect class="box" x="2780" y="100" width="260" height="50" rx="4"/>
        <text class="small" x="2910" y="128" text-anchor="middle">Tipo_Usuario</text>
        
        <ellipse class="oval" cx="2910" cy="40" rx="116" ry="22"/><text class="mini" x="2910" y="44" text-anchor="middle">Descripcion</text>
        <path class="edge" d="M2910 62 L2910 100" />
        
        <ellipse class="oval" cx="3100" cy="120" rx="106" ry="22"/><text class="mini" x="3100" y="124" text-anchor="middle">ID_tipousu</text>
        <path class="edge" d="M3040 120 L3060 120" />
      </g>
      <path class="edge" d="M2910 220 L2910 150" /><text class="small" x="2915" y="180">1</text>

      <!-- USUARIO -> REALIZA -> PRÉSTAMO -->
      <g id="R_Realiza">
        <polygon class="diamond" points="3300,530 3340,500 3380,530 3340,560"/>
        <text class="small" x="3340" y="536" text-anchor="middle">Realiza</text>
        <text class="small" x="3340" y="494" text-anchor="middle">1:N</text>
      </g>
      <path class="edge" d="M3040 530 L3300 530" /><text class="small" x="3110" y="518">1</text>

      <!-- PRÉSTAMO -->
      <g id="Prestamo">
        <rect class="box" x="3500" y="500" width="340" height="60" rx="4"/>
        <text class="label" x="3670" y="536" text-anchor="middle">Préstamo</text>
        
        <ellipse class="oval" cx="3550" cy="350" rx="130" ry="26"/><text class="mini" x="3550" y="354" text-anchor="middle">ID_prestamo</text>
        <path class="edge" d="M3550 350 L3550 500" />
        
        <ellipse class="oval" cx="3800" cy="350" rx="150" ry="26"/><text class="mini" x="3800" y="354" text-anchor="middle">FechaPrestamo</text>
        <path class="edge" d="M3800 350 L3800 500" />
        
        <ellipse class="oval" cx="3550" cy="700" rx="230" ry="28"/><text class="mini" x="3550" y="704" text-anchor="middle">FechaDevolucionEsperada</text>
        <path class="edge" d="M3550 560 L3550 672" />
        
        <ellipse class="oval" cx="3800" cy="700" rx="200" ry="28"/><text class="mini" x="3800" y="704" text-anchor="middle">FechaDevolucionReal</text>
        <path class="edge" d="M3800 560 L3800 672" />
        
        <ellipse class="oval" cx="3950" cy="560" rx="110" ry="26"/><text class="mini" x="3950" y="564" text-anchor="middle">Status</text>
        <path class="edge" d="M3840 530 L3920 560" />
      </g>
      <path class="edge" d="M3380 530 L3500 530" /><text class="small" x="3440" y="518">*</text>

      <!-- ===================== BANDA MEDIA: LIBRO / TIPO / IDIOMA ===================== -->
      
      <!-- LIBRO -->
      <g id="Libro">
        <rect class="box" x="2080" y="1500" width="450" height="70" rx="4"/>
        <text class="label" x="2305" y="1540" text-anchor="middle">Libro</text>
        
        <!-- Atributos superiores muy separados -->
        <ellipse class="oval" cx="1980" cy="1350" rx="115" ry="26"/><text class="mini" x="1980" y="1354" text-anchor="middle">ID_libro</text>
        <path class="edge" d="M1980 1350 L1980 1400 L2080 1400 L2080 1500" />
        
        <ellipse class="oval" cx="2305" cy="1350" rx="105" ry="26"/><text class="mini" x="2305" y="1354" text-anchor="middle">Titulo</text>
        <path class="edge" d="M2305 1350 L2305 1500" />
        
        <ellipse class="oval" cx="2600" cy="1250" rx="160" ry="26"/><text class="mini" x="2600" y="1254" text-anchor="middle">AnioPublicacion</text>
        <path class="edge" d="M2600 1250 L2600 1400 L2530 1400 L2530 1500" />
        
        <!-- Atributos inferiores -->
        <ellipse class="oval" cx="1980" cy="1700" rx="125" ry="26"/><text class="mini" x="1980" y="1704" text-anchor="middle">Subtitulo</text>
        <path class="edge" d="M1980 1700 L1980 1600 L2080 1600 L2080 1570" />
        
        <ellipse class="oval" cx="2305" cy="1700" rx="115" ry="26"/><text class="mini" x="2305" y="1704" text-anchor="middle">ISBN13</text>
        <path class="edge" d="M2305 1570 L2305 1700" />
        
        <ellipse class="oval" cx="2600" cy="1700" rx="115" ry="26"/><text class="mini" x="2600" y="1704" text-anchor="middle">ISBN10</text>
        <path class="edge" d="M2530 1570 L2530 1650 L2600 1650 L2600 1700" />
        
        <ellipse class="oval" cx="2800" cy="1600" rx="110" ry="26"/><text class="mini" x="2800" y="1604" text-anchor="middle">Edicion</text>
        <path class="edge" d="M2530 1530 L2700 1530 L2700 1600 L2774 1600" />
      </g>

      <!-- PUBLICADO POR (N:1) - Editorial arriba y completamente separado -->
      <g id="R_Publicado">
        <polygon class="diamond" points="2080,1250 2120,1220 2160,1250 2120,1280"/>
        <text class="small" x="2120" y="1256" text-anchor="middle">Publicado por</text>
      </g>
      <!-- Conexión sin pasar cerca de los atributos -->
      <path class="edge" d="M2120 1280 L2120 1400 L2200 1400 L2200 1500" />
      <text class="small" x="2126" y="1350">N</text>

      <!-- EDITORIAL -->
      <g id="Editorial">
        <rect class="box" x="2000" y="1050" width="240" height="50" rx="4"/>
        <text class="small" x="2120" y="1080" text-anchor="middle">Editorial</text>
        
        <ellipse class="oval" cx="1900" cy="1064" rx="98" ry="24"/><text class="mini" x="1900" y="1068" text-anchor="middle">Nombre</text>
        <path class="edge" d="M2000 1064 L1940 1064" />
        
        <ellipse class="oval" cx="2300" cy="1064" rx="120" ry="24"/><text class="mini" x="2300" y="1068" text-anchor="middle">ID_editorial</text>
        <path class="edge" d="M2240 1064 L2260 1064" />
      </g>
      <path class="edge" d="M2120 1220 L2120 1100" />
      <text class="small" x="2126" y="1150">1</text>

      <!-- ES TIPO (N:1) -> TIPO_LIBRO -->
      <g id="R_Tipo">
        <polygon class="diamond" points="2950,1535 2990,1505 3030,1535 2990,1565"/>
        <text class="small" x="2990" y="1541" text-anchor="middle">Es tipo</text>
      </g>
      <path class="edge" d="M2530 1535 L2950 1535" /><text class="small" x="2700" y="1520">N</text>

      <!-- TIPO_LIBRO -->
      <g id="Tipo_Libro">
        <rect class="box" x="3150" y="1500" width="360" height="70" rx="4"/>
        <text class="small" x="3330" y="1540" text-anchor="middle">Tipo_Libro</text>
        
        <ellipse class="oval" cx="3330" cy="1350" rx="150" ry="26"/><text class="mini" x="3330" y="1354" text-anchor="middle">ID_tipolibro</text>
        <path class="edge" d="M3330 1350 L3330 1500" />
        
        <ellipse class="oval" cx="3330" cy="1700" rx="164" ry="26"/><text class="mini" x="3330" y="1704" text-anchor="middle">Descripcion</text>
        <path class="edge" d="M3330 1570 L3330 1674" />
      </g>
      <path class="edge" d="M3030 1535 L3150 1535" /><text class="small" x="3090" y="1520">1</text>

      <!-- EN IDIOMA (N:1) -> IDIOMA -->
      <g id="R_Idioma">
        <polygon class="diamond" points="3800,1535 3840,1505 3880,1535 3840,1565"/>
        <text class="small" x="3840" y="1541" text-anchor="middle">En idioma</text>
      </g>
      <path class="edge" d="M3510 1535 L3800 1535" /><text class="small" x="3650" y="1520">N</text>

      <!-- IDIOMA -->
      <g id="Idioma">
        <rect class="box" x="4000" y="1500" width="340" height="70" rx="4"/>
        <text class="small" x="4170" y="1540" text-anchor="middle">Idioma</text>
        
        <ellipse class="oval" cx="4170" cy="1350" rx="156" ry="26"/><text class="mini" x="4170" y="1354" text-anchor="middle">ID_idioma</text>
        <path class="edge" d="M4170 1350 L4170 1500" />
        
        <ellipse class="oval" cx="4170" cy="1700" rx="164" ry="26"/><text class="mini" x="4170" y="1704" text-anchor="middle">Descripcion</text>
        <path class="edge" d="M4170 1570 L4170 1674" />
      </g>
      <path class="edge" d="M3880 1535 L4000 1535" /><text class="small" x="3940" y="1520">1</text>

      <!-- ===================== BANDA INFERIOR: AUTOR / GÉNERO / EJEMPLAR ===================== -->
      
      <!-- ESCRIBE (N:M) -> AUTOR (corredor izquierda) -->
      <g id="R_Escribe">
        <polygon class="diamond" points="1700,2100 1740,2070 1780,2100 1740,2130"/>
        <text class="small" x="1740" y="2106" text-anchor="middle">Escribe</text>
        <text class="small" x="1780" y="2090">N:M</text>
      </g>
      <!-- Ruta con amplio desvío para evitar otros elementos -->
      <path class="edge" d="M2080 1530 L1600 1530 L1600 2100 L1700 2100" />
      <text class="small" x="1640" y="1900">*</text>

      <!-- AUTOR -->
      <g id="Autor">
        <rect class="box" x="1560" y="2300" width="360" height="70" rx="4"/>
        <text class="small" x="1740" y="2340" text-anchor="middle">Autor</text>
        
        <ellipse class="oval" cx="1560" cy="2450" rx="130" ry="26"/><text class="mini" x="1560" y="2454" text-anchor="middle">ID_autor</text>
        <path class="edge" d="M1580 2370 L1576 2426" />
        
        <ellipse class="oval" cx="1920" cy="2450" rx="118" ry="26"/><text class="mini" x="1920" y="2454" text-anchor="middle">Nombre</text>
        <path class="edge" d="M1900 2370 L1910 2426" />
        
        <ellipse class="oval" cx="1740" cy="2550" rx="120" ry="26"/><text class="mini" x="1740" y="2554" text-anchor="middle">Apellido</text>
        <path class="edge" d="M1740 2370 L1740 2526" />
      </g>
      <path class="edge" d="M1740 2130 L1740 2300" /><text class="small" x="1748" y="2220">*</text>

      <!-- SE CLASIFICA (N:M) -> GÉNERO (columna centro) -->
      <g id="R_Clasifica">
        <polygon class="diamond" points="2305,2100 2345,2070 2385,2100 2345,2130"/>
        <text class="small" x="2345" y="2106" text-anchor="middle">Se clasifica</text>
        <text class="small" x="2385" y="2090">N:M</text>
      </g>
      <!-- Ruta vertical dedicada -->
      <path class="edge" d="M2305 1570 L2305 2070" />
      <text class="small" x="2314" y="1900">*</text>

      <!-- GÉNERO -->
      <g id="Genero">
        <rect class="box" x="2165" y="2300" width="360" height="70" rx="4"/>
        <text class="small" x="2345" y="2340" text-anchor="middle">Género</text>
        
        <ellipse class="oval" cx="2345" cy="2450" rx="136" ry="26"/><text class="mini" x="2345" y="2454" text-anchor="middle">ID_genero</text>
        <path class="edge" d="M2345 2300 L2345 2426" />
        
        <ellipse class="oval" cx="2345" cy="2550" rx="156" ry="26"/><text class="mini" x="2345" y="2554" text-anchor="middle">Descripcion</text>
        <path class="edge" d="M2345 2370 L2345 2526" />
      </g>
      <path class="edge" d="M2345 2130 L2345 2300" /><text class="small" x="2354" y="2220">*</text>

      <!-- TIENE (1:N) -> EJEMPLAR (corredor derecha) -->
      <g id="R_Tiene">
        <polygon class="diamond" points="3260,2100 3300,2070 3340,2100 3300,2130"/>
        <text class="small" x="3300" y="2106" text-anchor="middle">Tiene</text>
      </g>
      <!-- Ruta con amplio rodeo para evitar otras relaciones -->
      <path class="edge" d="M2530 1570 L3000 1570 L3000 2100 L3260 2100" />
      <text class="small" x="2980" y="1900">1</text>

      <!-- EJEMPLAR -->
      <g id="Ejemplar">
        <rect class="box" x="3500" y="2300" width="420" height="70" rx="4"/>
        <text class="small" x="3710" y="2340" text-anchor="middle">Ejemplar</text>
        
        <ellipse class="oval" cx="3500" cy="2450" rx="132" ry="26"/><text class="mini" x="3500" y="2454" text-anchor="middle">ID_ejemplar</text>
        <path class="edge" d="M3520 2370 L3516 2426" />
        
        <ellipse class="oval" cx="3900" cy="2450" rx="160" ry="26"/><text class="mini" x="3900" y="2454" text-anchor="middle">CodigoBarras</text>
        <path class="edge" d="M3880 2370 L3890 2426" />
        
        <ellipse class="oval" cx="3500" cy="2550" rx="130" ry="26"/><text class="mini" x="3500" y="2554" text-anchor="middle">Ubicacion</text>
        <path class="edge" d="M3520 2370 L3516 2526" />
        
        <ellipse class="oval" cx="3900" cy="2550" rx="176" ry="26"/><text class="mini" x="3900" y="2554" text-anchor="middle">EstadoEjemplar</text>
        <path class="edge" d="M3880 2370 L3890 2526" />
      </g>
      <path class="edge" d="M3340 2100 L3500 2100 L3500 2300" /><text class="small" x="3420" y="2090">*</text>

      <!-- CONTIENE (N:M) PRÉSTAMO->EJEMPLAR (corredor extremo derecha) -->
      <g id="R_Contiene">
        <polygon class="diamond" points="4600,1300 4640,1270 4680,1300 4640,1330"/>
        <text class="small" x="4640" y="1306" text-anchor="middle">Contiene</text>
        <text class="small" x="4680" y="1290">N:M</text>
      </g>
      <!-- Ruta que baja desde Préstamo y rodea todo hasta Ejemplar -->
      <path class="edge" d="M3670 560 L3670 900 L4600 900 L4600 1270" />
      <text class="small" x="3680" y="800">*</text>
      <path class="edge" d="M4680 1300 L5000 1300 L5000 2450 L3900 2450" />
      <text class="small" x="4900" y="1900">*</text><text class="small" x="4620" y="1900">*</text>

    </svg>
  </div>
</main>

<script>
  function exportSVG(){
    const svg = document.getElementById('erd');
    const xml = new XMLSerializer().serializeToString(svg);
    const blob = new Blob(['<?xml version="1.0" encoding="UTF-8"?>\n'+xml], {type:'image/svg+xml'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = 'ERD_Biblioteca_V13.svg';
    document.body.appendChild(a); a.click(); setTimeout(()=>{URL.revokeObjectURL(url); a.remove();},0);
  }
  function exportPNG(){
    const svg = document.getElementById('erd');
    const xml = new XMLSerializer().serializeToString(svg);
    const img = new Image();
    img.onload = function(){
      const scale = 2;
      const canvas = document.createElement('canvas');
      canvas.width = img.width * scale;
      canvas.height = img.height * scale;
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = '#fff'; ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      canvas.toBlob(b=>{
        const url = URL.createObjectURL(b);
        const a = document.createElement('a'); a.href = url; a.download = 'ERD_Biblioteca_V13.png';
        document.body.appendChild(a); a.click(); setTimeout(()=>{URL.revokeObjectURL(url); a.remove();},0);
      }, 'image/png', 1.0);
    };
    img.src = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<?xml version="1.0"?>\n' + xml);
  }
  document.getElementById('btnSvg').onclick = exportSVG;
  document.getElementById('btnPng').onclick = exportPNG;
</script>
</body>
</html>